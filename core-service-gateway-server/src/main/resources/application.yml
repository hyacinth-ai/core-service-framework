spring:
  application:
    name: gateway-server

  session:
    store-type: redis
    timeout: 1800s

  redis:
    url: redis://redis:alice-secret@192.168.99.100:6379

  cloud:
    gateway:
      discovery:
        locator:
          enabled: true

#      httpclient:
#        ssl:
#          useInsecureTrustManager: true
#          trustedX509Certificates:
#          - cert1.pem
#          - cert2.pem

server:
  port: 9090
#  ssl:
#    enabled: true
#    key-alias: scg
#    key-store-password: scg1234
#    key-store: classpath:scg-keystore.p12
#    key-store-type: PKCS12

logging:
  level:
    org:
      springframework:
        security: DEBUG

management:
  endpoints:
    web:
      exposure:
        include: "*"

ai.hyacinth.core.service.gateway.server:
  security:
    authenticated-required: true
    logout-url: /auth-service/api/logout
  rules:
  - path: /auth-service/api/login
    method: POST
    authority: any
    service: user-service
    uri: /api/authentication/login
    authentication-api: true
    post-processing: api
  - path: /user-service/api/users/current
    authority: admin, user
    service: user-service
    uri: /api/users/current
  - path: /order-service/api/orders
    method: POST
    authority: user
    service: debug-service
    uri: /api/orders
    request-body:
      userId: ${X-Principle}
      otherId: 123
    request-param:
      test: ${X-Principle}
  - path: /order-service/api/{*call}
    authority: admin, api
    service: order-service
    uri: "/api{call}"

#zuul:
#  host:
#    maxTotalConnections: 200
#    maxPerRouteConnections: 30
#
#  ignoredServices: '*'
#
#  prefix: /api
#  stripPrefix: false
#
#  routes:
#    user-service:
#      path: /user-service/**
#      serviceId: user-service
